--- a/src/libcharon/plugins/uci/uci_parser.c
+++ b/src/libcharon/plugins/uci/uci_parser.c
@@ -73,8 +73,7 @@ METHOD(enumerator_t, section_enumerator_
 	value = va_arg(args, char**);
 	if (value)
 	{
-		if (uci_lookup(this->ctx, &element, this->package,
-					   this->current->name, "name") == UCI_OK)
+		if (uci_lookup_next(this->ctx, &element, &this->current->list, "name") == UCI_OK)
 		{	/* use "name" attribute as config name if available ... */
 			*value = uci_to_option(element)->value;
 		}
@@ -88,8 +87,7 @@ METHOD(enumerator_t, section_enumerator_
 	for (i = 0; this->keywords[i]; i++)
 	{
 		value = va_arg(args, char**);
-		if (value && uci_lookup(this->ctx, &element, this->package,
-						  this->current->name, this->keywords[i]) == UCI_OK)
+		if (value && uci_lookup_next(this->ctx, &element, &this->current->list, this->keywords[i]) == UCI_OK)
 		{
 			*value = uci_to_option(element)->value;
 		}
